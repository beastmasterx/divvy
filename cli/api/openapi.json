{"openapi":"3.1.0","info":{"title":"Divvy API","description":"Group expense splitting and settlement API","version":"3.0.0"},"paths":{"/api/v1/auth/register":{"post":{"tags":["authentication"],"summary":"Register","description":"Register a new user account.\n\nCreates a new user with the provided email, name, and password.\nReturns a JWT access token and refresh token upon successful registration.\n\nArgs:\n    request: Registration request containing email, name, and password\n    http: HTTP request object for extracting device info\n    authentication_service: Authentication service instance\n\nReturns:\n    TokenResponse containing access token and refresh token\n\nRaises:\n    ConflictError: If email already exists (raised by authentication_service)","operationId":"register_api_v1_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/token":{"post":{"tags":["authentication"],"summary":"Token","description":"OAuth2 token endpoint - issue and refresh access tokens (RFC 6749).\n\nSupports two grant types:\n- password: Authenticate with username and password\n- refresh_token: Exchange refresh token for new access token\n\nArgs:\n    http: HTTP request object for extracting device info\n    grant_type: OAuth2 grant type (\"password\" or \"refresh_token\")\n    username: User email (required for password grant)\n    password: User password (required for password grant)\n    refresh_token: Refresh token (required for refresh_token grant)\n    authentication_service: Authentication service instance\n\nReturns:\n    TokenResponse containing access token and refresh token\n\nRaises:\n    ValidationError: If grant_type is invalid or required parameters are missing\n    UnauthorizedError: If credentials are invalid or refresh token is invalid/expired","operationId":"token_api_v1_auth_token_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_token_api_v1_auth_token_post"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/revoke":{"post":{"tags":["authentication"],"summary":"Revoke Token","description":"OAuth2 token revocation endpoint (RFC 7009).\n\nRevokes a refresh token. Note: This implementation only supports revoking refresh tokens.\nAccess tokens are stateless JWTs and cannot be revoked/blacklisted in this system.\n\nArgs:\n    token: Refresh token to revoke (OAuth2 standard form parameter, required)\n    token_type_hint: Hint about the token type (accepted but only \"refresh_token\" is supported)\n    authentication_service: Authentication service instance\n\nRaises:\n    ValidationError: If token is not provided\n    UnauthorizedError: If token is invalid\n\nNote:\n    Access tokens cannot be revoked in this implementation as they are stateless JWTs.\n    To invalidate access tokens, revoke the associated refresh token and wait for\n    the access token to expire naturally.","operationId":"revoke_token_api_v1_auth_revoke_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_revoke_token_api_v1_auth_revoke_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/logout-all":{"post":{"tags":["authentication"],"summary":"Logout All","description":"Logout from all devices by revoking all refresh tokens for the authenticated user.\n\nRequires Authorization header with valid access token.\n\nArgs:\n    user: Current authenticated user from access token\n    authentication_service: Authentication service instance","operationId":"logout_all_api_v1_auth_logout_all_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/auth/oauth/{provider}/authorize":{"get":{"tags":["authentication"],"summary":"Oauth Authorize","description":"Initiate OAuth flow by redirecting to identity provider.\n\nThis endpoint starts the OAuth2 Authorization Code flow. It redirects the user\nto the identity provider's authorization page where they authenticate, then the\nprovider redirects back to our callback endpoint.\n\nOAuth Flow Overview:\n===================\n1. Client calls this endpoint (GET /oauth/{provider}/authorize)\n   - Optional: Include `state` parameter for CSRF protection\n   - State can be:\n     * Frontend-generated random string (login flow): Frontend verifies on return\n     * Backend-generated signed JWT token (link flow): Backend verifies on callback\n\n2. Backend redirects user to provider's authorization page (HTTP 302)\n   - User authenticates with provider (Microsoft, Google, etc.)\n   - Provider redirects back to: {frontend_url}/auth/callback/{provider}\n\n3. Frontend receives callback at /auth/callback/{provider}\n   - Extracts `code` and `state` from query parameters\n   - Calls backend: GET /oauth/{provider}/callback?code=...&state=...\n\n4. Backend handles callback (oauth_callback endpoint):\n   - Exchanges authorization code for access token\n   - Gets user info from provider\n   - Determines flow based on state and existing accounts:\n     a) Identity exists → Return tokens (user already linked)\n     b) Signed state token with operation=\"link\" → Directly link account (authenticated user)\n     c) Email exists → Create link request (requires password verification)\n     d) New user → Create account and identity, return tokens\n\n5. Client receives response:\n   - TokenResponse: Authentication successful, contains access_token and refresh_token\n   - LinkingRequiredResponse: Account linking required, contains request_token for approval\n\nState Parameter:\n===============\nThe state parameter serves different purposes depending on the flow:\n\nLogin Flow (Frontend-Generated State):\n- Frontend generates random string (e.g., crypto.randomUUID())\n- Frontend stores state and verifies it matches on callback\n- Backend passes state through without verification\n- Purpose: CSRF protection\n\nLink Flow (Backend-Generated Signed State Token):\n- Backend creates signed JWT via create_state_token(operation=\"link\", user_id=...)\n- Backend verifies token signature and expiration on callback\n- Token contains: operation=\"link\", user_id, nonce, exp, iat\n- Purpose: Stateless context for authenticated account linking\n\nArgs:\n    provider: Identity provider name (e.g., 'microsoft', 'google')\n    state: Optional state parameter for CSRF protection\n        - Frontend-generated: Random string (frontend verifies)\n        - Backend-generated: Signed JWT token (backend verifies)\n    identity_provider_service: Identity provider service instance\n\nReturns:\n    HTTP 302 redirect to OAuth provider authorization URL\n\nRaises:\n    ValueError: If provider is not registered\n\nExample:\n    # Login flow (frontend generates state)\n    GET /oauth/microsoft/authorize?state=550e8400-e29b-41d4-a716-446655440000\n    → Redirects to Microsoft login page\n\n    # Link flow (backend generates signed state token)\n    POST /link/microsoft/initiate (with auth token)\n    → Returns authorization_url with signed state token\n    → Frontend redirects to that URL","operationId":"oauth_authorize_api_v1_auth_oauth__provider__authorize_get","parameters":[{"name":"provider","in":"path","required":true,"schema":{"$ref":"#/components/schemas/IdentityProviderName"}},{"name":"state","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"State"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/oauth/{provider}/callback":{"get":{"tags":["authentication"],"summary":"Oauth Callback","description":"Handle OAuth callback from identity provider.\n\nExchanges the authorization code for tokens and either:\n- Returns tokens if user is authenticated (new account or existing linked account)\n- Returns account linking info if email already exists (requires password verification)\n\nThe response includes a `response_type` field that indicates which type of response:\n- `\"token\"`: Authentication succeeded, contains access_token and refresh_token\n- `\"linking_required\"`: Account linking required, contains request_token and email\n\nArgs:\n    provider: Identity provider name (e.g., 'microsoft', 'google')\n    code: Authorization code from OAuth provider\n    state: Optional state parameter (should match the one sent in authorize)\n    http: HTTP request object for extracting device info\n    identity_provider_service: Identity provider service instance\n\nReturns:\n    TokenResponse (response_type=\"token\") if authenticated,\n    or LinkingRequiredResponse (response_type=\"linking_required\") if linking required\n\nRaises:\n    ValueError: If provider is not registered\n    UnauthorizedError: If OAuth flow fails","operationId":"oauth_callback_api_v1_auth_oauth__provider__callback_get","parameters":[{"name":"provider","in":"path","required":true,"schema":{"$ref":"#/components/schemas/IdentityProviderName"}},{"name":"code","in":"query","required":true,"schema":{"type":"string","description":"Authorization code from OAuth provider","title":"Code"},"description":"Authorization code from OAuth provider"},{"name":"state","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"State"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"oneOf":[{"$ref":"#/components/schemas/TokenResponse"},{"$ref":"#/components/schemas/LinkingRequiredResponse"}],"discriminator":{"propertyName":"response_type","mapping":{"token":"#/components/schemas/TokenResponse","linking_required":"#/components/schemas/LinkingRequiredResponse"}},"title":"Response Oauth Callback Api V1 Auth Oauth  Provider  Callback Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/link/{provider}/initiate":{"post":{"tags":["authentication"],"summary":"Initiate Account Link","description":"Initiate account linking for an authenticated user.\n\nCreates a signed state token with the user's ID and operation context,\nthen returns the OAuth authorization URL that the client should redirect to.\nThe state token ensures that when the OAuth callback returns, we know:\n- This is a link operation (not a login)\n- Which user is requesting the link\n\nRequires Authorization header with valid access token.\n\nArgs:\n    provider: Identity provider name (e.g., 'microsoft', 'google')\n    current_user: Current authenticated user from access token\n    identity_provider_service: Identity provider service instance\n\nReturns:\n    OAuthAuthorizeResponse containing the authorization URL with signed state token\n\nRaises:\n    ValueError: If provider is not registered","operationId":"initiate_account_link_api_v1_auth_link__provider__initiate_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"provider","in":"path","required":true,"schema":{"$ref":"#/components/schemas/IdentityProviderName"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OAuthAuthorizeResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/auth/link/approve":{"post":{"tags":["authentication"],"summary":"Approve Account Link","description":"Approve an account link request for an authenticated user.\n\nThis endpoint verifies the authenticated user matches the account link request\nand then links the external identity to the existing user account.\n\nArgs:\n    request: Account link approval request with token\n    current_user: Current authenticated user (required)\n    account_link_request_service: Account link request service instance\n\nReturns:\n    None (204 No Content on success)\n\nRaises:\n    NotFoundError: If request not found\n    ValidationError: If request is expired or already processed\n    UnauthorizedError: If authenticated user doesn't match request","operationId":"approve_account_link_api_v1_auth_link_approve_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AccountLinkVerifyRequest"}}},"required":true},"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/categories/":{"get":{"tags":["categories"],"summary":"Get All Categories","description":"List all categories.\n\nReturns:\n    List of all categories, ordered by ID","operationId":"get_all_categories_api_v1_categories__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/CategoryResponse"},"type":"array","title":"Response Get All Categories Api V1 Categories  Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/groups/":{"get":{"tags":["groups"],"summary":"Get Groups By User Id","description":"List all groups that the current user is a member of.","operationId":"get_groups_by_user_id_api_v1_groups__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/GroupResponse"},"type":"array","title":"Response Get Groups By User Id Api V1 Groups  Get"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"post":{"tags":["groups"],"summary":"Create Group","description":"Create a new group.\nAny authenticated user can create a group (becomes owner automatically).","operationId":"create_group_api_v1_groups__post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupRequest"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/api/v1/groups/{group_id}":{"get":{"tags":["groups"],"summary":"Get Group By Id","description":"Get a specific group by its ID.\nRequires group membership (owner, admin, or member).","operationId":"get_group_by_id_api_v1_groups__group_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["groups"],"summary":"Update Group","description":"Update a specific group by its ID.\nRequires group owner or admin role.","operationId":"update_group_api_v1_groups__group_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["groups"],"summary":"Delete Group","description":"Delete a specific group by its ID.\nRequires group owner role.","operationId":"delete_group_api_v1_groups__group_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/groups/{group_id}/users/{user_id}":{"put":{"tags":["groups"],"summary":"Transfer Group Owner","description":"Transfer the ownership of a specific group by its ID to a new owner.","operationId":"transfer_group_owner_api_v1_groups__group_id__users__user_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}},{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["groups"],"summary":"Remove User From Group","description":"Remove a user from a group.","operationId":"remove_user_from_group_api_v1_groups__group_id__users__user_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}},{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/groups/{group_id}/users/{user_id}/{role}":{"put":{"tags":["groups"],"summary":"Assign Group Role","description":"Assign a role to a user in a group.","operationId":"assign_group_role_api_v1_groups__group_id__users__user_id___role__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}},{"name":"user_id","in":"path","required":true,"schema":{"type":"integer","title":"User Id"}},{"name":"role","in":"path","required":true,"schema":{"$ref":"#/components/schemas/GroupRole"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/groups/{group_id}/periods":{"get":{"tags":["groups"],"summary":"Get Periods","description":"Get all periods for a specific group.\nRequires group membership (owner, admin, or member).","operationId":"get_periods_api_v1_groups__group_id__periods_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PeriodResponse"},"title":"Response Get Periods Api V1 Groups  Group Id  Periods Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["groups"],"summary":"Create Period","description":"Create a new period.\nRequires owner or admin role in the group specified in the request.","operationId":"create_period_api_v1_groups__group_id__periods_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PeriodRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PeriodResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/groups/{group_id}/periods/current":{"get":{"tags":["groups"],"summary":"Get Current Period","description":"Get the current active period for a specific group.\nRequires group membership (owner, admin, or member).","operationId":"get_current_period_api_v1_groups__group_id__periods_current_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"group_id","in":"path","required":true,"schema":{"type":"integer","title":"Group Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PeriodResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/transactions/{transaction_id}":{"get":{"tags":["transactions"],"summary":"Get Transaction By Id","description":"Get a specific transaction by its ID.","operationId":"get_transaction_by_id_api_v1_transactions__transaction_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"transaction_id","in":"path","required":true,"schema":{"type":"integer","title":"Transaction Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["transactions"],"summary":"Update Transaction","description":"Update an existing transaction.","operationId":"update_transaction_api_v1_transactions__transaction_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"transaction_id","in":"path","required":true,"schema":{"type":"integer","title":"Transaction Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["transactions"],"summary":"Delete Transaction","description":"Delete a transaction by its ID.","operationId":"delete_transaction_api_v1_transactions__transaction_id__delete","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"transaction_id","in":"path","required":true,"schema":{"type":"integer","title":"Transaction Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/transactions/{transaction_id}/approve":{"put":{"tags":["transactions"],"summary":"Approve Transaction","description":"Approve a pending transaction.","operationId":"approve_transaction_api_v1_transactions__transaction_id__approve_put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"transaction_id","in":"path","required":true,"schema":{"type":"integer","title":"Transaction Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/transactions/{transaction_id}/reject":{"put":{"tags":["transactions"],"summary":"Reject Transaction","description":"Reject a pending transaction.","operationId":"reject_transaction_api_v1_transactions__transaction_id__reject_put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"transaction_id","in":"path","required":true,"schema":{"type":"integer","title":"Transaction Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/transactions/{transaction_id}/submit":{"put":{"tags":["transactions"],"summary":"Submit Transaction","description":"Submit a draft transaction.","operationId":"submit_transaction_api_v1_transactions__transaction_id__submit_put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"transaction_id","in":"path","required":true,"schema":{"type":"integer","title":"Transaction Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/transactions/{transaction_id}/draft":{"put":{"tags":["transactions"],"summary":"Draft Transaction","description":"Draft a pending transaction.","operationId":"draft_transaction_api_v1_transactions__transaction_id__draft_put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"transaction_id","in":"path","required":true,"schema":{"type":"integer","title":"Transaction Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/periods/{period_id}":{"get":{"tags":["periods"],"summary":"Get Period","description":"Get a specific period by its ID.\nRequires group membership for the period's group.","operationId":"get_period_api_v1_periods__period_id__get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period_id","in":"path","required":true,"schema":{"type":"integer","title":"Period Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PeriodResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["periods"],"summary":"Update Period","description":"Update a specific period by its ID.\nRequires owner or admin role in the period's group.","operationId":"update_period_api_v1_periods__period_id__put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period_id","in":"path","required":true,"schema":{"type":"integer","title":"Period Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PeriodRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PeriodResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/periods/{period_id}/close":{"put":{"tags":["periods"],"summary":"Close Period","description":"Close a specific period by its ID.\nRequires owner or admin role in the period's group.","operationId":"close_period_api_v1_periods__period_id__close_put","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period_id","in":"path","required":true,"schema":{"type":"integer","title":"Period Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PeriodResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/periods/{period_id}/transactions":{"get":{"tags":["periods"],"summary":"Get Transactions","description":"Get the transactions for a specific period.\nRequires group membership for the period's group.","operationId":"get_transactions_api_v1_periods__period_id__transactions_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period_id","in":"path","required":true,"schema":{"type":"integer","title":"Period Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TransactionResponse"},"title":"Response Get Transactions Api V1 Periods  Period Id  Transactions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["periods"],"summary":"Create Transaction","description":"Create a new transaction.","operationId":"create_transaction_api_v1_periods__period_id__transactions_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period_id","in":"path","required":true,"schema":{"type":"integer","title":"Period Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TransactionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/periods/{period_id}/balances":{"get":{"tags":["periods"],"summary":"Get Balances","description":"Get the balances for a specific period.\nRequires group membership for the period's group.\n\nReturns a list of user balances where:\n- Positive balance = user is owed money\n- Negative balance = user owes money","operationId":"get_balances_api_v1_periods__period_id__balances_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period_id","in":"path","required":true,"schema":{"type":"integer","title":"Period Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/BalanceResponse"},"title":"Response Get Balances Api V1 Periods  Period Id  Balances Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/periods/{period_id}/get-settlement-plan":{"get":{"tags":["periods"],"summary":"Get Settlement Plan","description":"Get the settlement plan for a specific period.\nRequires group membership for the period's group.","operationId":"get_settlement_plan_api_v1_periods__period_id__get_settlement_plan_get","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period_id","in":"path","required":true,"schema":{"type":"integer","title":"Period Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SettlementResponse"},"title":"Response Get Settlement Plan Api V1 Periods  Period Id  Get Settlement Plan Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/periods/{period_id}/apply-settlement-plan":{"post":{"tags":["periods"],"summary":"Apply Settlement Plan","description":"Apply the settlement plan and settle the period.\nRequires owner or admin role in the period's group.","operationId":"apply_settlement_plan_api_v1_periods__period_id__apply_settlement_plan_post","security":[{"OAuth2PasswordBearer":[]}],"parameters":[{"name":"period_id","in":"path","required":true,"schema":{"type":"integer","title":"Period Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/user/me":{"get":{"tags":["user"],"summary":"Get Current User Info","description":"Get current authenticated user's information.\n\nReturns the user information for the currently authenticated user\nbased on the JWT token in the Authorization header.\n\nArgs:\n    user: Current authenticated user from dependency\n\nReturns:\n    UserResponse containing user information","operationId":"get_current_user_info_api_v1_user_me_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}}},"security":[{"OAuth2PasswordBearer":[]}]},"put":{"tags":["user"],"summary":"Update User Profile","description":"Update current authenticated user's profile.","operationId":"update_user_profile_api_v1_user_me_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProfileRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"OAuth2PasswordBearer":[]}]}},"/":{"get":{"summary":"Root","description":"Root endpoint.","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/health":{"get":{"summary":"Health Check","description":"Health check endpoint.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"AccountLinkVerifyRequest":{"properties":{"request_token":{"type":"string","title":"Request Token","description":"Account link request token"}},"type":"object","required":["request_token"],"title":"AccountLinkVerifyRequest","description":"Request schema for verifying an account link request."},"BalanceResponse":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"ID of the user"},"balance":{"type":"integer","title":"Balance","description":"Net balance in cents. Positive = user is owed money, Negative = user owes money"}},"type":"object","required":["user_id","balance"],"title":"BalanceResponse","description":"Schema for user balance in a period."},"Body_revoke_token_api_v1_auth_revoke_post":{"properties":{"token":{"type":"string","title":"Token"},"token_type_hint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Token Type Hint"}},"type":"object","required":["token"],"title":"Body_revoke_token_api_v1_auth_revoke_post"},"Body_token_api_v1_auth_token_post":{"properties":{"grant_type":{"type":"string","title":"Grant Type","default":"password"},"username":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Username"},"password":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Password"},"refresh_token":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Refresh Token"}},"type":"object","title":"Body_token_api_v1_auth_token_post"},"CategoryResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Category ID"},"name":{"type":"string","title":"Name","description":"Category name"},"is_default":{"type":"boolean","title":"Is Default","description":"Whether the category is a default category"}},"type":"object","required":["id","name","is_default"],"title":"CategoryResponse","description":"Schema for category response."},"ExpenseShareRequest":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"ID of the user who shared the transaction"},"transaction_id":{"type":"integer","title":"Transaction Id","description":"ID of the transaction who shared the transaction"},"share_amount":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Share Amount","description":"Amount of the share in cents"},"share_percentage":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Share Percentage","description":"Percentage of the share"}},"type":"object","required":["user_id","transaction_id"],"title":"ExpenseShareRequest","description":"Schema for share request."},"ExpenseShareResponse":{"properties":{"user_id":{"type":"integer","title":"User Id","description":"ID of the user who shared the transaction"},"transaction_id":{"type":"integer","title":"Transaction Id","description":"ID of the transaction who shared the transaction"},"share_amount":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Share Amount","description":"Amount of the share in cents"},"share_percentage":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Share Percentage","description":"Percentage of the share"}},"type":"object","required":["user_id","transaction_id"],"title":"ExpenseShareResponse","description":"Schema for share response."},"GroupRequest":{"properties":{"name":{"type":"string","title":"Name","description":"Group name"}},"type":"object","required":["name"],"title":"GroupRequest","description":"Schema for group request."},"GroupResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Group ID"},"name":{"type":"string","title":"Name","description":"Group name"}},"type":"object","required":["id","name"],"title":"GroupResponse","description":"Schema for group response."},"GroupRole":{"type":"string","enum":["group:owner","group:admin","group:member"],"title":"GroupRole","description":"Roles within a group context."},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IdentityProviderName":{"type":"string","enum":["microsoft","google","facebook"],"title":"IdentityProviderName","description":"Supported identity provider names."},"LinkingRequiredResponse":{"properties":{"response_type":{"type":"string","const":"linking_required","title":"Response Type","description":"Response type discriminator - indicates account linking is required","default":"linking_required"},"requires_linking":{"type":"boolean","title":"Requires Linking","description":"Whether account linking is required","default":true},"request_token":{"type":"string","title":"Request Token","description":"Token for account linking request"},"email":{"type":"string","title":"Email","description":"Email address for account linking"},"message":{"type":"string","title":"Message","description":"Message explaining the account linking requirement"}},"type":"object","required":["request_token","email","message"],"title":"LinkingRequiredResponse","description":"Response schema for OAuth callback when account linking is required."},"OAuthAuthorizeResponse":{"properties":{"authorization_url":{"type":"string","title":"Authorization Url","description":"URL to redirect user to for OAuth login"}},"type":"object","required":["authorization_url"],"title":"OAuthAuthorizeResponse","description":"Response schema for OAuth authorization URL."},"PeriodRequest":{"properties":{"name":{"type":"string","title":"Name","description":"Period name"}},"type":"object","required":["name"],"title":"PeriodRequest","description":"Schema for period request."},"PeriodResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"Period ID"},"group_id":{"type":"integer","title":"Group Id","description":"Group ID"},"name":{"type":"string","title":"Name","description":"Period name"},"status":{"$ref":"#/components/schemas/PeriodStatus","description":"Period status"},"start_date":{"type":"string","format":"date-time","title":"Start Date","description":"Period start date"},"end_date":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"End Date","description":"Period end date"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At","description":"Period created at"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At","description":"Period updated at"},"created_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Created By","description":"Period created by"},"updated_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Updated By","description":"Period updated by"}},"type":"object","required":["id","group_id","name","status","start_date"],"title":"PeriodResponse","description":"Schema for period response."},"PeriodStatus":{"type":"string","enum":["open","closed","settled"],"title":"PeriodStatus","description":"Enumeration of period lifecycle states.\n\nAttributes:\n    OPEN: Active period allowing transaction creation and modification.\n          Balances are calculated dynamically as transactions change.\n    CLOSED: Period locked for new transactions. Used for reconciliation\n            and final reporting. Balances are finalized. May be reopened\n            by administrators if needed.\n    SETTLED: Final immutable state indicating all outstanding balances\n             have been paid. This status cannot be changed once set."},"ProfileRequest":{"properties":{"email":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Email","description":"User's email address"},"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name","description":"User's full name"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active","description":"Whether the user account is active","default":true},"avatar":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar","description":"URL to user's avatar image"}},"type":"object","title":"ProfileRequest","description":"Schema for updating user profile."},"RegisterRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email","description":"User's email address"},"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"User's full name"},"password":{"type":"string","minLength":8,"title":"Password","description":"User's password (minimum 8 characters)"}},"type":"object","required":["email","name","password"],"title":"RegisterRequest","description":"Request schema for user registration."},"SettlementResponse":{"properties":{"payer_id":{"type":"integer","title":"Payer Id","description":"ID of the user who pays (debtor)"},"payee_id":{"type":"integer","title":"Payee Id","description":"ID of the user who receives (creditor)"},"amount":{"type":"integer","title":"Amount","description":"Amount to transfer in cents"},"period_id":{"type":"integer","title":"Period Id","description":"ID of the period being settled"},"payer_name":{"type":"string","title":"Payer Name","description":"Name of the user who pays"},"payee_name":{"type":"string","title":"Payee Name","description":"Name of the user who receives"},"period_name":{"type":"string","title":"Period Name","description":"Name of the period"}},"type":"object","required":["payer_id","payee_id","amount","period_id","payer_name","payee_name","period_name"],"title":"SettlementResponse","description":"Schema for settlement response representing money transfers between users."},"SplitKind":{"type":"string","enum":["personal","equal","amount","percentage"],"title":"SplitKind","description":"Enumeration of methods for splitting transaction costs among users.\n\nAttributes:\n    PERSONAL: Only the payer bears the cost (no split among participants).\n    EQUAL: Split equally among all participants in the transaction.\n    AMOUNT: Custom fixed amounts per person (specified in cents).\n    PERCENTAGE: Custom percentage allocation per person (0.0 to 100.0)."},"TokenResponse":{"properties":{"response_type":{"type":"string","const":"token","title":"Response Type","description":"Response type discriminator - only used in OAuth callback endpoint for discriminated union. Not part of OAuth2 RFC 6749 spec.","default":"token"},"access_token":{"type":"string","title":"Access Token","description":"The access token issued by the authorization server (OAuth 2.0 RFC 6749)"},"token_type":{"type":"string","title":"Token Type","description":"The type of token issued. Value is case-insensitive per OAuth 2.0 RFC 6749","default":"Bearer"},"expires_in":{"type":"integer","title":"Expires In","description":"The lifetime in seconds of the access token (OAuth 2.0 RFC 6749)"},"refresh_token":{"type":"string","title":"Refresh Token","description":"The refresh token used to obtain new access tokens (OAuth 2.0 RFC 6749)"},"scope":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Scope","description":"The scope of the access token as a space-delimited string (OAuth 2.0 RFC 6749, optional)"}},"type":"object","required":["access_token","expires_in","refresh_token"],"title":"TokenResponse","description":"OAuth2 token endpoint response schema (RFC 6749).\n\nThis response follows the OAuth2 specification for token endpoint responses.\nField order matches OAuth2 standard: access_token, token_type, expires_in, refresh_token, scope."},"TransactionKind":{"type":"string","enum":["expense","deposit","refund"],"title":"TransactionKind","description":"Enumeration of transaction types in the expense splitting system.\n\nAttributes:\n    EXPENSE: Standard expense transaction where a user pays for something\n             shared with others.\n    DEPOSIT: Money deposited into the group's shared pool.\n    REFUND: Money returned or refunded to participants."},"TransactionRequest":{"properties":{"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Transaction description"},"amount":{"type":"integer","title":"Amount","description":"Transaction amount in cents"},"payer_id":{"type":"integer","title":"Payer Id","description":"ID of the user who paid the transaction"},"category_id":{"type":"integer","title":"Category Id","description":"ID of the category of the transaction"},"transaction_kind":{"$ref":"#/components/schemas/TransactionKind","description":"Kind of transaction"},"split_kind":{"$ref":"#/components/schemas/SplitKind","description":"Kind of split"},"expense_shares":{"anyOf":[{"items":{"$ref":"#/components/schemas/ExpenseShareRequest"},"type":"array"},{"type":"null"}],"title":"Expense Shares","description":"Expense shares for the transaction"}},"type":"object","required":["amount","payer_id","category_id","transaction_kind","split_kind"],"title":"TransactionRequest","description":"Schema for transaction request."},"TransactionResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"ID of the transaction"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Transaction description"},"amount":{"type":"integer","title":"Amount","description":"Transaction amount in cents"},"payer_id":{"type":"integer","title":"Payer Id","description":"ID of the user who paid the transaction"},"category_id":{"type":"integer","title":"Category Id","description":"ID of the category of the transaction"},"period_id":{"type":"integer","title":"Period Id","description":"ID of the period of the transaction"},"payer_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Payer Name","description":"Name of the user who paid the transaction"},"category_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Category Name","description":"Name of the category of the transaction"},"period_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Period Name","description":"Name of the period of the transaction"},"transaction_kind":{"$ref":"#/components/schemas/TransactionKind","description":"Kind of transaction"},"split_kind":{"$ref":"#/components/schemas/SplitKind","description":"Kind of split"},"status":{"$ref":"#/components/schemas/TransactionStatus","description":"Status of the transaction"},"expense_shares":{"anyOf":[{"items":{"$ref":"#/components/schemas/ExpenseShareResponse"},"type":"array"},{"type":"null"}],"title":"Expense Shares","description":"Expense shares for the transaction"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At","description":"Transaction created at"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At","description":"Transaction updated at"},"created_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Created By","description":"Transaction created by"},"updated_by":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Updated By","description":"Transaction updated by"}},"type":"object","required":["id","amount","payer_id","category_id","period_id","transaction_kind","split_kind","status"],"title":"TransactionResponse","description":"Schema for transaction response."},"TransactionStatus":{"type":"string","enum":["draft","pending","approved","rejected"],"title":"TransactionStatus","description":"Enumeration of transaction lifecycle states.\n\nAttributes:\n    DRAFT: Transaction is being created or edited. Not yet finalized.\n    PENDING: Transaction is submitted and awaiting approval.\n    APPROVED: Transaction has been approved and is active in the period.\n    REJECTED: Transaction has been rejected and will not be processed."},"UserResponse":{"properties":{"id":{"type":"integer","title":"Id","description":"User ID"},"email":{"type":"string","title":"Email","description":"User's email address"},"name":{"type":"string","title":"Name","description":"User's full name"},"avatar":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Avatar","description":"URL to user's avatar image"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active","description":"Whether the user account is active"}},"type":"object","required":["id","email","name"],"title":"UserResponse","description":"Response schema for user information."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"OAuth2PasswordBearer":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/api/v1/auth/token"}}}}}}